<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                    #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable     #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts       #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances      #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE GADTs                  #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses  #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes             #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables    #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell        #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies           #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators          #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances   #-}</span><span>
</span><a name="line-14"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Module      :  Plots.Types</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- Copyright   :  (C) 2015 Christopher Chalmers</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Maintainer  :  Christopher Chalmers</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- Portability :  non-portable</span><span>
</span><a name="line-22"></a><span class="hs-comment">--</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- This module defines the various types for holding plots:</span><span>
</span><a name="line-24"></a><span class="hs-comment">--</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- [@'PlotOptions' b v n@]</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- Generic options all plots have.</span><span>
</span><a name="line-27"></a><span class="hs-comment">--</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- [@'PlotMods' b v n@]</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- Includes 'PlotOptions' along with modifications to the 'PlotStyle'.</span><span>
</span><a name="line-30"></a><span class="hs-comment">--</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- [@'Plot' p b@]</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- A 'rawPlot' @p@ grouped with a 'PlotMods'.</span><span>
</span><a name="line-33"></a><span class="hs-comment">--</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- [@'DynamicPlot' b v n@]</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- A wrapped up 'Plot' so it can be stored in an 'Axis'.</span><span>
</span><a name="line-36"></a><span class="hs-comment">--</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- [@'StyledPlot' b v n@]</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- A 'DynamicPlot' with a concrete 'PlotStyle', ready to be rendered.</span><span>
</span><a name="line-39"></a><span class="hs-comment">--</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- As well as other things like the 'Plotable' class, 'LegendEntries',</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- 'HasOrientation' and 'HasVisibility'.</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><a name="line-44"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plots</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">(</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- * Plot options</span><span>
</span><a name="line-48"></a><span>    </span><a href="Plots.Types.html#PlotOptions"><span class="hs-identifier hs-type">PlotOptions</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#HasPlotOptions"><span class="hs-identifier hs-type">HasPlotOptions</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#key"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#addLegendEntry"><span class="hs-identifier hs-var">addLegendEntry</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- ** Plot modifications</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#PlotMods"><span class="hs-identifier hs-type">PlotMods</span></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#plotMods"><span class="hs-identifier hs-var">plotMods</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-comment">-- * Plotable class</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#Plotable"><span class="hs-identifier hs-type">Plotable</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-comment">-- * Plot types</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-comment">-- ** Parameterised plot</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#Plot"><span class="hs-identifier hs-type">Plot</span></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#mkPlot"><span class="hs-identifier hs-var">mkPlot</span></a><span>
</span><a name="line-64"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#rawPlot"><span class="hs-identifier hs-var">rawPlot</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-comment">-- ** Dynamic plot</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#DynamicPlot"><span class="hs-identifier hs-type">DynamicPlot</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#_DynamicPlot"><span class="hs-identifier hs-var">_DynamicPlot</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#dynamicPlot"><span class="hs-identifier hs-var">dynamicPlot</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#dynamicPlotMods"><span class="hs-identifier hs-var">dynamicPlotMods</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-comment">-- ** Styled plot</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#StyledPlot"><span class="hs-identifier hs-type">StyledPlot</span></a><span>
</span><a name="line-74"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#styledPlot"><span class="hs-identifier hs-var">styledPlot</span></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#styleDynamic"><span class="hs-identifier hs-var">styleDynamic</span></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#renderStyledPlot"><span class="hs-identifier hs-var">renderStyledPlot</span></a><span>
</span><a name="line-77"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#singleStyledPlotLegend"><span class="hs-identifier hs-var">singleStyledPlotLegend</span></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#styledPlotLegends"><span class="hs-identifier hs-var">styledPlotLegends</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>  </span><span class="hs-comment">-- * Miscellaneous</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-comment">-- ** Visibility</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#HasVisibility"><span class="hs-identifier hs-type">HasVisibility</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#hide"><span class="hs-identifier hs-var">hide</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#display"><span class="hs-identifier hs-var">display</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span>  </span><span class="hs-comment">-- ** Orientation</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#HasOrientation"><span class="hs-identifier hs-type">HasOrientation</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#orient"><span class="hs-identifier hs-var">orient</span></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#horizontal"><span class="hs-identifier hs-var">horizontal</span></a><span>
</span><a name="line-91"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#vertical"><span class="hs-identifier hs-var">vertical</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-comment">-- ** Legend entries</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">LegendEntry</span></a><span>
</span><a name="line-95"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#LegendPic"><span class="hs-identifier hs-type">LegendPic</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#mkLegendEntry"><span class="hs-identifier hs-var">mkLegendEntry</span></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#legendPicture"><span class="hs-identifier hs-var">legendPicture</span></a><span>
</span><a name="line-98"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#legendText"><span class="hs-identifier hs-var">legendText</span></a><span>
</span><a name="line-99"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#legendPrecedence"><span class="hs-identifier hs-var">legendPrecedence</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-comment">-- ** Axis spec</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#AxisSpec"><span class="hs-identifier hs-type">AxisSpec</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#specTrans"><span class="hs-identifier hs-var">specTrans</span></a><span>
</span><a name="line-104"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#specBounds"><span class="hs-identifier hs-var">specBounds</span></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#specScale"><span class="hs-identifier hs-var">specScale</span></a><span>
</span><a name="line-106"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#scaleNum"><span class="hs-identifier hs-var">scaleNum</span></a><span>
</span><a name="line-107"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#specPoint"><span class="hs-identifier hs-var">specPoint</span></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#specColourMap"><span class="hs-identifier hs-var">specColourMap</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-comment">-- ** Positioning</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#HasPlacement"><span class="hs-identifier hs-type">HasPlacement</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#HasGap"><span class="hs-identifier hs-type">HasGap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#placeAgainst"><span class="hs-identifier hs-var">placeAgainst</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-comment">-- *** Common positions</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-comment">-- **** Inside positions</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#topLeft"><span class="hs-identifier hs-var">topLeft</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#top"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#topRight"><span class="hs-identifier hs-var">topRight</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#left"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#right"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#bottomLeft"><span class="hs-identifier hs-var">bottomLeft</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#bottom"><span class="hs-identifier hs-var">bottom</span></a><span>
</span><a name="line-119"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#bottomRight"><span class="hs-identifier hs-var">bottomRight</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>  </span><span class="hs-comment">-- **** Outside positions</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#leftAbove"><span class="hs-identifier hs-var">leftAbove</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#leftTop"><span class="hs-identifier hs-var">leftTop</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#leftMid"><span class="hs-identifier hs-var">leftMid</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#leftBottom"><span class="hs-identifier hs-var">leftBottom</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#leftBelow"><span class="hs-identifier hs-var">leftBelow</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#midAbove"><span class="hs-identifier hs-var">midAbove</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#midBelow"><span class="hs-identifier hs-var">midBelow</span></a><span>
</span><a name="line-123"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#rightAbove"><span class="hs-identifier hs-var">rightAbove</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#rightTop"><span class="hs-identifier hs-var">rightTop</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#rightMid"><span class="hs-identifier hs-var">rightMid</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#rightBottom"><span class="hs-identifier hs-var">rightBottom</span></a><span class="hs-special">,</span><span> </span><a href="Plots.Types.html#rightBelow"><span class="hs-identifier hs-var">rightBelow</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span>
</span><a name="line-128"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bool</span><span>
</span><a name="line-129"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sortBy</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Ord</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">comparing</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Orphans</span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-134"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Diagrams</span><span class="hs-operator">.</span><span class="hs-identifier">Prelude</span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">D</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span>           </span><a href="Plots.Axis.Scale.html"><span class="hs-identifier">Plots</span><span class="hs-operator">.</span><span class="hs-identifier">Axis</span><span class="hs-operator">.</span><span class="hs-identifier">Scale</span></a><span>
</span><a name="line-137"></a><span class="hs-keyword">import</span><span>           </span><a href="Plots.Style.html"><span class="hs-identifier">Plots</span><span class="hs-operator">.</span><span class="hs-identifier">Style</span></a><span>
</span><a name="line-138"></a><span class="hs-keyword">import</span><span>           </span><a href="Plots.Util.html"><span class="hs-identifier">Plots</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- Orientation ---------------------------------------------------------</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-keyword">data</span><span> </span><a name="Orientation"><a href="Plots.Types.html#Orientation"><span class="hs-identifier">Orientation</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Horizontal"><a href="Plots.Types.html#Horizontal"><span class="hs-identifier">Horizontal</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Vertical"><a href="Plots.Types.html#Vertical"><span class="hs-identifier">Vertical</span></a></a><span>
</span><a name="line-143"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Pick the first @a@ if the object has 'Horizontal' orientation and</span><span>
</span><a name="line-146"></a><span class="hs-comment">--   the second @a@ if the object has a 'Vertical' orientation.</span><span>
</span><a name="line-147"></a><span class="hs-identifier">orient</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Plots.Types.html#HasOrientation"><span class="hs-identifier hs-type">HasOrientation</span></a><span> </span><a href="#local-1627867085"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627867085"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867086"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867086"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867086"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-148"></a><a name="orient"><a href="Plots.Types.html#orient"><span class="hs-identifier">orient</span></a></a><span> </span><a name="local-1627867087"><a href="#local-1627867087"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-1627867088"><a href="#local-1627867088"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-1627867089"><a href="#local-1627867089"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">view</span><span> </span><a href="Plots.Types.html#orientation"><span class="hs-identifier hs-var">orientation</span></a><span> </span><a href="#local-1627867087"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-150"></a><span>    </span><a href="Plots.Types.html#Horizontal"><span class="hs-identifier hs-var">Horizontal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867088"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-151"></a><span>    </span><a href="Plots.Types.html#Vertical"><span class="hs-identifier hs-var">Vertical</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867089"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Class of things that have an orientation.</span><span>
</span><a name="line-154"></a><span class="hs-keyword">class</span><span> </span><a name="HasOrientation"><a href="Plots.Types.html#HasOrientation"><span class="hs-identifier">HasOrientation</span></a></a><span> </span><a name="local-1627867059"><a href="#local-1627867059"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-comment">-- | Lens onto the orientation of an object.</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-identifier">orientation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867059"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Plots.Types.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-keyword">instance</span><span> </span><a href="Plots.Types.html#HasOrientation"><span class="hs-identifier hs-type">HasOrientation</span></a><span> </span><a href="Plots.Types.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-159"></a><span>  </span><a name="local-1913079662"><a href="Plots.Types.html#orientation"><span class="hs-identifier">orientation</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">-- | Lens onto whether an object's orientation is horizontal.</span><span>
</span><a name="line-162"></a><span class="hs-identifier">horizontal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Plots.Types.html#HasOrientation"><span class="hs-identifier hs-type">HasOrientation</span></a><span> </span><a href="#local-1627867084"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867084"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-163"></a><a name="horizontal"><a href="Plots.Types.html#horizontal"><span class="hs-identifier">horizontal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#orientation"><span class="hs-identifier hs-var">orientation</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">iso</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><a href="Plots.Types.html#Horizontal"><span class="hs-identifier hs-var">Horizontal</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bool</span><span> </span><a href="Plots.Types.html#Vertical"><span class="hs-identifier hs-var">Vertical</span></a><span> </span><a href="Plots.Types.html#Horizontal"><span class="hs-identifier hs-var">Horizontal</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- | Lens onto whether an object's orientation is vertical.</span><span>
</span><a name="line-166"></a><span class="hs-identifier">vertical</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Plots.Types.html#HasOrientation"><span class="hs-identifier hs-type">HasOrientation</span></a><span> </span><a href="#local-1627867083"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867083"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-167"></a><a name="vertical"><a href="Plots.Types.html#vertical"><span class="hs-identifier">vertical</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#horizontal"><span class="hs-identifier hs-var">horizontal</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">involuted</span><span> </span><span class="hs-identifier hs-var">not</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- Placement</span><span>
</span><a name="line-171"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-keyword">class</span><span> </span><a name="HasGap"><a href="Plots.Types.html#HasGap"><span class="hs-identifier">HasGap</span></a></a><span> </span><a name="local-1627867058"><a href="#local-1627867058"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-comment">-- | The value of the gap when rendering.</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-identifier">gap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867058"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">N</span><span> </span><a href="#local-1627867058"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | A 'Position' is a point on an axis together with an anchor and a</span><span>
</span><a name="line-178"></a><span class="hs-comment">--   direction for the gap.</span><span>
</span><a name="line-179"></a><span class="hs-keyword">data</span><span> </span><a name="Placement"><a href="Plots.Types.html#Placement"><span class="hs-identifier">Placement</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Placement"><a href="Plots.Types.html#Placement"><span class="hs-identifier">Placement</span></a></a><span>
</span><a name="line-180"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="pAt"><a href="Plots.Types.html#pAt"><span class="hs-identifier">pAt</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="pAnchor"><a href="Plots.Types.html#pAnchor"><span class="hs-identifier">pAnchor</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-182"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="pGapDir"><a href="Plots.Types.html#pGapDir"><span class="hs-identifier">pGapDir</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Direction</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-184"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>  </span><span class="hs-comment">-- In the future the axis position may be replaced by a reader-like</span><span>
</span><a name="line-186"></a><span>  </span><span class="hs-comment">-- anchor system where you can choose parts of the rendered axis as a</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-comment">-- position.</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-comment">-- we keep posGap and posGapDir as separate values to keep lens laws</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-comment">-- for 0 gaps</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-comment">-- I'm not sure this should work for a 3D axis</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-keyword">class</span><span> </span><a name="HasPlacement"><a href="Plots.Types.html#HasPlacement"><span class="hs-identifier">HasPlacement</span></a></a><span> </span><a name="local-1627867051"><a href="#local-1627867051"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-identifier">placement</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867051"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span>  </span><span class="hs-comment">-- | The position relative to the axis. @V2 0 0@ corresponds to the</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-comment">--   bottom left corner, @V2 1 1@ is the top right corner.</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-identifier">placementAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867051"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>  </span><a name="local-1913079651"><a href="Plots.Types.html#placementAt"><span class="hs-identifier">placementAt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#placement"><span class="hs-identifier hs-var">placement</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lens</span><span> </span><span class="hs-identifier">pAt</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627867052"><a href="#local-1627867052"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627867053"><a href="#local-1627867053"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867052"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pAt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867053"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>  </span><span class="hs-comment">-- | The anchor used for the object being positioned. @V2 0 0@</span><span>
</span><a name="line-201"></a><span>  </span><span class="hs-comment">--   corresponds to the bottom left corner, @V2 1 1@ is the top right</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-comment">--   corner.</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-identifier">placementAnchor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867051"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>  </span><a name="local-1913079652"><a href="Plots.Types.html#placementAnchor"><span class="hs-identifier">placementAnchor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#placement"><span class="hs-identifier hs-var">placement</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lens</span><span> </span><span class="hs-identifier">pAnchor</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627867054"><a href="#local-1627867054"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627867055"><a href="#local-1627867055"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867054"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pAnchor</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867055"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>  </span><span class="hs-comment">-- | The direction to extend the 'gap' when positioning.</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-identifier">gapDirection</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lens'</span><span> </span><a href="#local-1627867051"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Direction</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>  </span><a name="local-1913079653"><a href="Plots.Types.html#gapDirection"><span class="hs-identifier">gapDirection</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#placement"><span class="hs-identifier hs-var">placement</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lens</span><span> </span><span class="hs-identifier">pGapDir</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627867056"><a href="#local-1627867056"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627867057"><a href="#local-1627867057"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867056"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">pGapDir</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867057"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-keyword">instance</span><span> </span><a href="Plots.Types.html#HasPlacement"><span class="hs-identifier hs-type">HasPlacement</span></a><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-211"></a><span>  </span><a name="local-1913079650"><a href="Plots.Types.html#placement"><span class="hs-identifier">placement</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- Inside positions ----------------------------------------------------</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- Internal helper for all inside placements</span><span>
</span><a name="line-216"></a><span class="hs-identifier">pInside</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span>
</span><a name="line-217"></a><a name="pInside"><a href="Plots.Types.html#pInside"><span class="hs-identifier">pInside</span></a></a><span> </span><a name="local-1627867090"><a href="#local-1627867090"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span>
</span><a name="line-218"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pAt</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867090"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-219"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pAnchor</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867090"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-220"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pGapDir</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#dirBetween%27"><span class="hs-identifier hs-var">dirBetween'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">P</span><span> </span><a href="#local-1627867090"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">origin</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- | @dirBetween p q@ returns the directions from @p@ to @q@</span><span>
</span><a name="line-224"></a><span class="hs-identifier">dirBetween'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Additive</span><span> </span><a href="#local-1627867081"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-1627867082"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Point</span><span> </span><a href="#local-1627867081"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-1627867082"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Point</span><span> </span><a href="#local-1627867081"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-1627867082"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Direction</span><span> </span><a href="#local-1627867081"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-1627867082"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-225"></a><a name="dirBetween%27"><a href="Plots.Types.html#dirBetween%27"><span class="hs-identifier">dirBetween'</span></a></a><span> </span><a name="local-1627867091"><a href="#local-1627867091"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627867092"><a href="#local-1627867092"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627867092"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">.-.</span><span> </span><a href="#local-1627867091"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">topLeft</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">top</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">topRight</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">left</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">right</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bottomLeft</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bottom</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bottomRight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span>
</span><a name="line-229"></a><a name="topLeft"><a href="Plots.Types.html#topLeft"><span class="hs-identifier">topLeft</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><a name="top"><a href="Plots.Types.html#top"><span class="hs-identifier">top</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-231"></a><a name="topRight"><a href="Plots.Types.html#topRight"><span class="hs-identifier">topRight</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-232"></a><a name="left"><a href="Plots.Types.html#left"><span class="hs-identifier">left</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><a name="right"><a href="Plots.Types.html#right"><span class="hs-identifier">right</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-234"></a><a name="bottomLeft"><a href="Plots.Types.html#bottomLeft"><span class="hs-identifier">bottomLeft</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><a name="bottom"><a href="Plots.Types.html#bottom"><span class="hs-identifier">bottom</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-236"></a><a name="bottomRight"><a href="Plots.Types.html#bottomRight"><span class="hs-identifier">bottomRight</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#pInside"><span class="hs-identifier hs-var">pInside</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- Outside positions ---------------------------------------------------</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-identifier">leftAbove</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leftTop</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leftMid</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leftBottom</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">leftBelow</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">midAbove</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">midBelow</span><span class="hs-special">,</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-identifier">rightAbove</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rightTop</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rightMid</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rightBottom</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rightBelow</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><a name="leftAbove"><a href="Plots.Types.html#leftAbove"><span class="hs-identifier">leftAbove</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><a name="leftTop"><a href="Plots.Types.html#leftTop"><span class="hs-identifier">leftTop</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><a name="leftMid"><a href="Plots.Types.html#leftMid"><span class="hs-identifier">leftMid</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><a name="leftBottom"><a href="Plots.Types.html#leftBottom"><span class="hs-identifier">leftBottom</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><a name="leftBelow"><a href="Plots.Types.html#leftBelow"><span class="hs-identifier">leftBelow</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><a name="midAbove"><a href="Plots.Types.html#midAbove"><span class="hs-identifier">midAbove</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><a name="midBelow"><a href="Plots.Types.html#midBelow"><span class="hs-identifier">midBelow</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><a name="rightAbove"><a href="Plots.Types.html#rightAbove"><span class="hs-identifier">rightAbove</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><a name="rightTop"><a href="Plots.Types.html#rightTop"><span class="hs-identifier">rightTop</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-254"></a><a name="rightMid"><a href="Plots.Types.html#rightMid"><span class="hs-identifier">rightMid</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>   </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><a name="rightBottom"><a href="Plots.Types.html#rightBottom"><span class="hs-identifier">rightBottom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><a name="rightBelow"><a href="Plots.Types.html#rightBelow"><span class="hs-identifier">rightBelow</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">1</span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">direction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span>   </span><span class="hs-number">0</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- Using positions -----------------------------------------------------</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- | A tool for aligned one object to another. Positions @b@ around the</span><span>
</span><a name="line-261"></a><span class="hs-comment">--   bounding box of @a@ by translating @b@.</span><span>
</span><a name="line-262"></a><span class="hs-identifier">placeAgainst</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">InSpace</span><span> </span><span class="hs-identifier hs-type">V2</span><span> </span><a href="#local-1627867078"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627867079"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SameSpace</span><span> </span><a href="#local-1627867079"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627867080"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enveloped</span><span> </span><a href="#local-1627867079"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span>
</span><a name="line-264"></a><span>      </span><span class="hs-identifier hs-type">HasOrigin</span><span> </span><a href="#local-1627867080"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Alignable</span><span> </span><a href="#local-1627867080"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627867079"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-type">Placement</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867078"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867080"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867080"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-266"></a><a name="placeAgainst"><a href="Plots.Types.html#placeAgainst"><span class="hs-identifier">placeAgainst</span></a></a><span> </span><a name="local-1627867093"><a href="#local-1627867093"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Plots.Types.html#Placement"><span class="hs-identifier hs-var">Placement</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><a name="local-1627867094"><a href="#local-1627867094"><span class="hs-identifier">px</span></a></a><span> </span><a name="local-1627867095"><a href="#local-1627867095"><span class="hs-identifier">py</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><a name="local-1627867096"><a href="#local-1627867096"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-1627867097"><a href="#local-1627867097"><span class="hs-identifier">ay</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627867098"><a href="#local-1627867098"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627867099"><a href="#local-1627867099"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627867100"><a href="#local-1627867100"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-267"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867100"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-1627867102"><span class="hs-identifier hs-var">anchor</span></a><span>
</span><a name="line-268"></a><span>      </span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-identifier hs-var">moveTo</span><span> </span><span class="hs-special">(</span><a href="#local-1627867101"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-operator hs-var">.+^</span><span> </span><a href="#local-1627867099"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">*^</span><span> </span><span class="hs-identifier hs-var">fromDirection</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span> </span><a href="#local-1627867098"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-identifier">pos</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkP2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lerp'</span><span> </span><span class="hs-identifier">px</span><span> </span><span class="hs-identifier">xu</span><span> </span><span class="hs-identifier">xl</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lerp'</span><span> </span><span class="hs-identifier">py</span><span> </span><span class="hs-identifier">yu</span><span> </span><span class="hs-identifier">yl</span><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>    </span><span class="hs-identifier">anchor</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">alignBy</span><span> </span><span class="hs-identifier">unitX</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromRational</span><span> </span><span class="hs-identifier">ax</span><span class="hs-special">)</span><span> </span><a href="#local-1627867106"><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">alignBy</span><span> </span><span class="hs-identifier">unitY</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromRational</span><span> </span><span class="hs-identifier">ay</span><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-special">(</span><a name="local-1627867102"><a href="#local-1627867102"><span class="hs-identifier">P</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627867102"><a href="#local-1627867102"><span class="hs-identifier">V2</span></a></a><span> </span><span class="hs-identifier">xl</span><span> </span><span class="hs-identifier hs-var">yl</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">P</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V2</span><span> </span><span class="hs-identifier">xu</span><span> </span><span class="hs-identifier hs-var">yu</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">origin</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">origin</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getCorners</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">boundingBox</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span>    </span><span class="hs-identifier">lerp'</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">u</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromRational</span><span> </span><span class="hs-identifier">alpha</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">u</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">fromRational</span><span> </span><span class="hs-identifier">alpha</span><span class="hs-special">)</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">v</span><span>
</span><a name="line-275"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">alpha</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">z</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- Legend entries</span><span>
</span><a name="line-279"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-comment">-- | Type allowing use of the default legend picture (depending on the</span><span>
</span><a name="line-282"></a><span class="hs-comment">--   plot) or a custom legend picture with access to the 'PlotStyle'.</span><span>
</span><a name="line-283"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">LegendPic</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DefaultLegendPic</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DefaultLegendPic"><a href="Plots.Types.html#DefaultLegendPic"><span class="hs-identifier">CustomLegendPic</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotStyle</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">QDiagram</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Any</span><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Default</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LegendPic</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-identifier">def</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DefaultLegendPic</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | Data type for holding a legend entry.</span><span>
</span><a name="line-291"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LegendEntry</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">lPic</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">LegendPic</span><span> </span><a name="LegendEntry"><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier">b</span></a></a><span> </span><a name="LegendEntry"><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier">v</span></a></a><span> </span><a name="LegendEntry"><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-293"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lText</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Plots.Types.html#LegendPic"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-294"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lPrecedence</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">n</span><span>
</span><a name="line-295"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-comment">-- | The picture used in the legend entry.</span><span>
</span><a name="line-298"></a><span class="hs-identifier">legendPicture</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Lens'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LegendPic</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span class="hs-identifier">legendPicture</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lens</span><span> </span><span class="hs-identifier">lPic</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">pic</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">lPic</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#LegendPic"><span class="hs-identifier hs-type">pic</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-comment">-- | The text used in the legend entry.</span><span>
</span><a name="line-302"></a><span class="hs-identifier">legendText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Lens'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-303"></a><span class="hs-identifier">legendText</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lens</span><span> </span><span class="hs-identifier">lText</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">txt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627867073"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">lText</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">txt</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- | The order in which the legend entries are rendered. If precedences</span><span>
</span><a name="line-306"></a><span class="hs-comment">--   are equal, the entries are put in the order they are added to the</span><span>
</span><a name="line-307"></a><span class="hs-comment">--   axis.</span><span>
</span><a name="line-308"></a><span class="hs-comment">--</span><span>
</span><a name="line-309"></a><span class="hs-comment">--   Default is @0@.</span><span>
</span><a name="line-310"></a><span class="hs-identifier">legendPrecedence</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Lens'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-311"></a><span class="hs-identifier">legendPrecedence</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lens</span><span> </span><span class="hs-identifier">lPrecedence</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">lPrecedence</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">V</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">v</span><span>
</span><a name="line-314"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">N</span><span> </span><span class="hs-special">(</span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">LegendEntry</span></a><span> </span><a href="#local-1627867169"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627867170"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-1627867171"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867170"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-comment">-- | Make a legend entry with a default 'legendPicture' and</span><span>
</span><a name="line-317"></a><span class="hs-comment">--   'legendPrecedence' 0 using the string as the 'legendText'.</span><span>
</span><a name="line-318"></a><span class="hs-identifier">mkLegendEntry</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-319"></a><span class="hs-identifier">mkLegendEntry</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">DefaultLegendPic</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-322"></a><span class="hs-comment">-- Plot attributes</span><span>
</span><a name="line-323"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- Generic Plot info</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">-- | Data type for holding information all plots must contain.</span><span>
</span><a name="line-328"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PlotOptions</span><span>
</span><a name="line-329"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">poName</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span>
</span><a name="line-330"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poClipPlot</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-331"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="poClipPlot"><a href="Plots.Types.html#poClipPlot"><span class="hs-identifier">poLegend</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><a name="line-332"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poVisible</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-333"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poTransform</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Transformation</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-334"></a><span>  </span><span class="hs-comment">-- , poPostPlotBoundingBox :: BoundingBox v n -&gt; BoundingBox v n</span><span>
</span><a name="line-335"></a><span>  </span><span class="hs-comment">-- , poPlotPostProduction  :: QDiagram b v n Any -&gt; QDiagram b v n Any</span><span>
</span><a name="line-336"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">V</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">v</span><span>
</span><a name="line-339"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">N</span><span> </span><span class="hs-special">(</span><a href="Plots.Types.html#PlotOptions"><span class="hs-identifier hs-type">PlotOptions</span></a><span> </span><a href="#local-1627867163"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627867164"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-1627867165"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627867164"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span class="hs-comment">-- | Class of things that have 'PlotOptions'.</span><span>
</span><a name="line-342"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">HasPlotOptions</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-343"></a><span>  </span><span class="hs-pragma">{-# MINIMAL plotOptions #-}</span><span>
</span><a name="line-344"></a><span>  </span><span class="hs-comment">-- | Lens onto the 'PlotOptions'.</span><span>
</span><a name="line-345"></a><span>  </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">LensLike'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">V</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span>  </span><span class="hs-comment">-- | The 'Name' applied to the plot. This gives a way to reference a</span><span>
</span><a name="line-348"></a><span>  </span><span class="hs-comment">--   specific plot in a rendered axis.</span><span>
</span><a name="line-349"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-350"></a><span>  </span><span class="hs-comment">--   'Default' is 'mempty'.</span><span>
</span><a name="line-351"></a><span>  </span><span class="hs-identifier">plotName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">LensLike'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">Name</span><span>
</span><a name="line-352"></a><span>  </span><span class="hs-identifier">plotName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">lens</span><span> </span><span class="hs-identifier">poName</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-type">g</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">poName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>  </span><span class="hs-pragma">{-# INLINE plotName #-}</span><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span>  </span><span class="hs-comment">-- | Whether the plot should be clipped to the bounds of the axes.</span><span>
</span><a name="line-356"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-357"></a><span>  </span><span class="hs-comment">--   'Default' is 'True'.</span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-identifier">clipPlot</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">LensLike'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-359"></a><span>  </span><span class="hs-identifier">clipPlot</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">lens</span><span> </span><span class="hs-identifier">poClipPlot</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">poClipPlot</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>  </span><span class="hs-pragma">{-# INLINE clipPlot #-}</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span>  </span><span class="hs-comment">-- | The legend entries to be used for the current plot.</span><span>
</span><a name="line-363"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-364"></a><span>  </span><span class="hs-comment">--   'Default' is 'mempty'.</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-identifier">legendEntries</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">LensLike'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LegendEntry</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">V</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-366"></a><span>  </span><span class="hs-identifier">legendEntries</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">lens</span><span> </span><span class="hs-identifier">poLegend</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">poLegend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>  </span><span class="hs-pragma">{-# INLINE legendEntries #-}</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span>  </span><span class="hs-comment">-- | The transform applied to the plot once it's in the axis</span><span>
</span><a name="line-370"></a><span>  </span><span class="hs-comment">--   coordinates.</span><span>
</span><a name="line-371"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-372"></a><span>  </span><span class="hs-comment">--   'Default' is 'mempty'.</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-identifier">plotTransform</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">LensLike'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Transformation</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">V</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>  </span><span class="hs-identifier">plotTransform</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">lens</span><span> </span><span class="hs-identifier">poTransform</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-type">g</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">g</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">poTransform</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>  </span><span class="hs-pragma">{-# INLINE plotTransform #-}</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span>  </span><span class="hs-comment">-- | Whether or not the plot should be shown. The 'BoundingBox' of the</span><span>
</span><a name="line-378"></a><span>  </span><span class="hs-comment">--   plot will still affect the inferred axis bounds.</span><span>
</span><a name="line-379"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-380"></a><span>  </span><span class="hs-comment">--   'Default' is 'True'.</span><span>
</span><a name="line-381"></a><span>  </span><span class="hs-identifier">plotVisible</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">LensLike'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-382"></a><span>  </span><span class="hs-identifier">plotVisible</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">lens</span><span> </span><span class="hs-identifier">poVisible</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">po</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">po</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">poVisible</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>  </span><span class="hs-pragma">{-# INLINE plotVisible #-}</span><span>
</span><a name="line-384"></a><span>
</span><a name="line-385"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Additive</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Default</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-386"></a><span>  </span><span class="hs-identifier">def</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PlotOptions</span><span>
</span><a name="line-387"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">poName</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><a name="line-388"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poClipPlot</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-389"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poLegend</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-390"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poVisible</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-391"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">poTransform</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-comment">-- , poPostPlotBoundingBox = id</span><span>
</span><a name="line-393"></a><span>    </span><span class="hs-comment">-- , poPlotPostProduction  = id</span><span>
</span><a name="line-394"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">HasPlotOptions</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-397"></a><span>  </span><span class="hs-identifier">plotOptions</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Plots.Types.html#HasPlotOptions"><span class="hs-identifier hs-type">id</span></a><span>
</span><a name="line-398"></a><span>  </span><span class="hs-pragma">{-# INLINE plotOptions #-}</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HasLinearMap</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Transformable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-401"></a><span>  </span><span class="hs-identifier">transform</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">over</span><span> </span><span class="hs-identifier">plotTransform</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">transform</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">-- instance HasBounds (PlotOptions b v n) v where</span><span>
</span><a name="line-404"></a><span class="hs-comment">--   bounds = plotBounds</span><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span class="hs-comment">-- | Move origin by applying to @plotTransform@.</span><span>
</span><a name="line-407"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Additive</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">HasOrigin</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-408"></a><span>  </span><span class="hs-identifier">moveOriginTo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">over</span><span> </span><span class="hs-identifier">plotTransform</span><span> </span><span class="hs-operator hs-type">.</span><span> </span><span class="hs-identifier">moveOriginTo</span><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Qualifiable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PlotOptions</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-411"></a><span>  </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">.&gt;&gt;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">over</span><span> </span><span class="hs-identifier">plotName</span><span> </span><span class="hs-special">(</span><a href="Plots.Types.html#PlotOptions"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="Plots.Types.html#PlotOptions"><span class="hs-operator hs-type">.&gt;&gt;</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627867142"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-comment">-- XXX template haskell getting in the way</span><span>
</span><a name="line-414"></a><span class="hs-comment">-- instance HasVisibility (PlotOptions b v n) where</span><span>
</span><a name="line-415"></a><span class="hs-comment">--   visible = plotVisible</span><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-comment">-- | Add a 'LegendEntry' to something with 'PlotOptions' using the</span><span>
</span><a name="line-418"></a><span class="hs-comment">--   'String' as the 'legendText' and a 'DefaultLegendPic'. Here are</span><span>
</span><a name="line-419"></a><span class="hs-comment">--   some typical examples:</span><span>
</span><a name="line-420"></a><span class="hs-comment">--</span><span>
</span><a name="line-421"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- 'key' :: 'String' -&gt; 'State' ('Plot' ('ScatterPlot' v n) b) ()</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- 'key' :: 'String' -&gt; 'State' ('DynamicPlot' b v n) ()</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- 'key' :: 'String' -&gt; 'State' ('PlotMods' b v n) ()</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-426"></a><span class="hs-comment">--</span><span>
</span><a name="line-427"></a><span class="hs-comment">--  If you only care about the name of the legend, use 'key'.</span><span>
</span><a name="line-428"></a><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HasPlotOptions</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadState</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span class="hs-identifier">key</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">addLegendEntry</span><span> </span><a href="Plots.Types.html#HasPlotOptions"><span class="hs-operator hs-type">.</span></a><span> </span><span class="hs-identifier">mkLegendEntry</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-comment">-- | Add a 'LegendEntry' to something with 'PlotOptions'. Here are some</span><span>
</span><a name="line-432"></a><span class="hs-comment">--   typical examples:</span><span>
</span><a name="line-433"></a><span class="hs-comment">--</span><span>
</span><a name="line-434"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- 'addLegendEntry' :: 'LegendEntry' b v n -&gt; 'State' ('Plot' ('ScatterPlot' v n) b) ()</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- 'addLegendEntry' :: 'LegendEntry' b v n -&gt; 'State' ('DynamicPlot' b v n) ()</span><span>
</span><a name="line-437"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-438"></a><span class="hs-comment">--</span><span>
</span><a name="line-439"></a><span class="hs-comment">--  If you only care about the name of the legend, use 'key'.</span><span>
</span><a name="line-440"></a><span class="hs-identifier">addLegendEntry</span><span>
</span><a name="line-441"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HasPlotOptions</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadState</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">LegendEntry</span><span> </span><a href="Plots.Types.html#HasPlotOptions"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">V</span><span> </span><span class="hs-identifier hs-type">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">N</span><span> </span><span class="hs-identifier hs-type">a</span><span class="hs-special">)</span><span>
</span><a name="line-443"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Plots.Types.html#LegendEntry"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-444"></a><span class="hs-identifier">addLegendEntry</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">legendEntries</span><span> </span><span class="hs-operator">&lt;&gt;=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span class="hs-comment">-- zeroInt :: Additive v =&gt; v Int</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- zeroInt = zero</span><span>
</span><a name="line-448"></a><span>
</span><a name="line-449"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-450"></a><span class="hs-comment">-- AxisSpec</span><span>
</span><a name="line-451"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- | Information from the 'Plots.Axis.Axis' necessary to render a 'Plotable'.</span><span>
</span><a name="line-454"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AxisSpec</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AxisSpec</span><span>
</span><a name="line-455"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_specBounds</span><span>    </span><span class="hs-glyph">::</span><span> </span><a name="AxisSpec"><a href="Plots.Types.html#AxisSpec"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a name="AxisSpec"><a href="Plots.Types.html#AxisSpec"><span class="hs-identifier">n</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><a name="line-456"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_specBounds"><a href="Plots.Types.html#_specBounds"><span class="hs-identifier">_specTrans</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Transformation</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-457"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_specTrans"><a href="Plots.Types.html#_specTrans"><span class="hs-identifier">_specScale</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">v</span><span> </span><span class="hs-identifier hs-type">LogScale</span><span>
</span><a name="line-458"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_specColourMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ColourMap</span><span>
</span><a name="line-459"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-char">''AxisSpec

type instance V (AxisSpec v n) = v
type instance N (AxisSpec v n) = n

-- | Scale a number by log10-ing it and linearly scaling it so it's
--   within the same range.
scaleNum :: Floating n =&gt; (n, n) -&gt; LogScale -&gt; n -&gt; n
scaleNum (a,b) s x = case s of
  LinearAxis -&gt; x
  LogAxis    -&gt; subtract a $ (b / logBase 10 d) * (logBase 10 x)
    where d = b - a

-- | Apply log scaling and the transform to a point.
specPoint :: (Applicative v, Additive v, Floating n) =&gt; AxisSpec v n -&gt; Point v n -&gt; Point v n
specPoint (AxisSpec bs tr ss _) p =
  papply tr $ over _Point (scaleNum &lt;$&gt; bs &lt;*&gt; ss &lt;*&gt;) p

------------------------------------------------------------------------
-- Plotable class
------------------------------------------------------------------------

-- | Class defining how plots should be rendered.
class (Typeable p, Enveloped p) =&gt; Plotable p b where
  -- | Render a plot according to the 'AxisSpec', using the 'PlotStyle'.
  renderPlotable
    :: InSpace v n p
    =&gt; AxisSpec v n
    -&gt; PlotStyle b v n
    -&gt; p
    -&gt; QDiagram b v n Any

  -- | The default legend picture when the 'LegendPic' is
  --   'DefaultLegendPic'.
  defLegendPic
    :: InSpace v n p
    =&gt; PlotStyle b v n
    -&gt; p
    -&gt; QDiagram b v n Any
  defLegendPic = mempty

instance (Typeable b, Typeable v, Metric v, Typeable n, OrderedField n)
  =&gt; Plotable (QDiagram b v n Any) b where
  renderPlotable s _ dia = dia # transform (s^.specTrans)

instance (TypeableFloat n, Renderable (Path V2 n) b) =&gt; Plotable (Path V2 n) b where
  renderPlotable s sty path
    = stroke path
        # transform (s^.specTrans)
        # applyLineStyle sty

  defLegendPic sty _
    = (p2 (-10,0) ~~ p2 (10,0))
        # applyLineStyle sty

------------------------------------------------------------------------
-- Visibility
------------------------------------------------------------------------

-- | Class of objects that can be hidden.
class HasVisibility a where
  -- | Lens onto whether an object should be visible when rendered.
  visible :: Lens' a Bool

  -- | The opposite of 'visible'.
  hidden :: Lens' a Bool
  hidden = visible . involuted not
  {-# INLINE hidden #-}

instance HasVisibility (PlotOptions b v n) where
  visible = plotVisible

instance HasVisibility (PlotMods b v n) where
  visible = plotVisible

instance HasVisibility (Plot p b) where
  visible = plotVisible

instance HasVisibility (DynamicPlot b v n) where
  visible = plotVisible

instance HasVisibility (StyledPlot b v n) where
  visible = plotVisible

-- | Set 'visible' to 'False' for the given setter.
--
-- @
-- 'hide' 'minorTicks'          :: 'State' ('Axis' b v n) ()
-- 'hide' ('xAxis' . 'gridLines') :: 'State' ('Axis' b v n) ()
-- @
hide :: (MonadState s m, HasVisibility a) =&gt; ASetter' s a -&gt; m ()
hide l = l . visible .= False

-- | Set 'visible' to 'True' for the given setter.
--
-- @
-- 'display' 'minorGridLines' :: 'State' ('Axis' b v n) ()
-- 'display' 'colourBar'      :: 'State' ('Axis' b v n) ()
-- @
display :: (MonadState s m, HasVisibility a) =&gt; ASetter' s a -&gt; m ()
display l = l . visible .= True

------------------------------------------------------------------------
-- Plot modification
------------------------------------------------------------------------

-- | A 'PlotOptions' with modifications to a 'PlotStyle'.
data PlotMods b v n
  = PlotMods (PlotOptions b v n) (PlotStyle b v n -&gt; PlotStyle b v n)

type instance V (PlotMods b v n) = v
type instance N (PlotMods b v n) = n

instance Functor f =&gt; HasPlotOptions f (PlotMods b v n) b where
  plotOptions f (PlotMods opts sty) = f opts &lt;&amp;&gt; \opts' -&gt; PlotMods opts' sty

instance Settable f =&gt; HasPlotStyle f (PlotMods b v n) b where
  plotStyle = sty . mapped where
    sty f (PlotMods opts s) = f s &lt;&amp;&gt; \s' -&gt; PlotMods opts s'

instance (Additive v, Num n) =&gt; Default (PlotMods b v n) where
  def = PlotMods def id

------------------------------------------------------------------------
-- Plot type
------------------------------------------------------------------------

-- | A parameterised plot, together with a 'PlotMods'. This type has an
--   instance of many classes for modifying specific plots.
data Plot p b =
  Plot p
       (PlotOptions b (V p) (N p))
       (PlotStyle b (V p) (N p) -&gt; PlotStyle b (V p) (N p))
  deriving Typeable

type instance V (Plot p b) = V p
type instance N (Plot p b) = N p

instance Functor f =&gt; HasPlotOptions f (Plot p b) b where
  plotOptions f (Plot p opts sty) = f opts &lt;&amp;&gt; \opts' -&gt; Plot p opts' sty

instance Settable f =&gt; HasPlotStyle f (Plot p b) b where
  plotStyle = sty . mapped where
    sty f (Plot p opts s) = f s &lt;&amp;&gt; \s' -&gt; Plot p opts s'

instance HasOrientation p =&gt; HasOrientation (Plot p b) where
  orientation = rawPlot . orientation

-- | Make a 'Plot' with 'Default' 'PlotOptions'.
mkPlot :: (Additive (V p), Num (N p)) =&gt; p -&gt; Plot p b
mkPlot p = Plot p def id

-- | Lens onto the raw 'Plotable' inside a 'Plot'.
rawPlot :: SameSpace p p' =&gt; Lens (Plot p b) (Plot p' b) p p'
rawPlot f (Plot p opts ps) = f p &lt;&amp;&gt; \p' -&gt; Plot p' opts ps

-- | The modifications to the 'PlotOptions' and 'PlotStyle' in a 'Plot'.
plotMods :: Lens' (Plot p b) (PlotMods b (V p) (N p))
plotMods f (Plot p opts ps) =
  f (PlotMods opts ps) &lt;&amp;&gt; \(PlotMods opts' ps') -&gt; Plot p opts' ps'

------------------------------------------------------------------------
-- DynamicPlot
------------------------------------------------------------------------

-- | A wrapped up 'Plot', used to store plots in an 'Axis'.
data DynamicPlot b v n where
  DynamicPlot :: (InSpace v n p, Plotable p b) =&gt; Plot p b -&gt; DynamicPlot b v n
  deriving Typeable

type instance V (DynamicPlot b v n) = v
type instance N (DynamicPlot b v n) = n

-- | Prism for a 'DynamicPlot'.
_DynamicPlot :: (Plotable p b, Typeable b) =&gt; Prism' (DynamicPlot b (V p) (N p)) (Plot p b)
_DynamicPlot = prism' DynamicPlot (\(DynamicPlot p) -&gt; cast p)

-- | Traversal over the dynamic plot without the 'Plotable' constraint
--   '_DynamicPlot' has.
dynamicPlot :: forall p b. (Typeable p, Typeable b)
            =&gt; Traversal' (DynamicPlot b (V p) (N p)) (Plot p b)
dynamicPlot f d@(DynamicPlot p) =
  case eq p of
    Just Refl -&gt; f p &lt;&amp;&gt; \p' -&gt; DynamicPlot p'
    Nothing   -&gt; pure d
  where eq :: Typeable a =&gt; a -&gt; Maybe (a :~: Plot p b)
        eq _ = eqT
instance Functor f =&gt; HasPlotOptions f (DynamicPlot b v n) b where
  plotOptions f (DynamicPlot (Plot p opts sty)) =
    f opts &lt;&amp;&gt; \opts' -&gt; DynamicPlot (Plot p opts' sty)

instance Settable f =&gt; HasPlotStyle f (DynamicPlot b v n) b where
  plotStyle = sty . mapped where
    sty :: Setter' (DynamicPlot b v n) (PlotStyle b v n -&gt; PlotStyle b v n)
    sty f (DynamicPlot (Plot p opts s)) = f s &lt;&amp;&gt; \s' -&gt; DynamicPlot (Plot p opts s')

-- | The modifications to the 'PlotOptions' and 'PlotStyle' in a 'DynamicPlot'.
dynamicPlotMods :: Lens' (DynamicPlot b v n) (PlotMods b v n)
dynamicPlotMods f (DynamicPlot (Plot p opts ps)) =
  f (PlotMods opts ps) &lt;&amp;&gt; \(PlotMods opts' ps') -&gt; DynamicPlot (Plot p opts' ps')

------------------------------------------------------------------------
-- StyledPlot
------------------------------------------------------------------------

-- | A 'DynamicPlot' with a concrete style. This is suitable for being
--   rendered with 'renderStyledPlot' and get extract the legend entries
--   with 'styledPlotLegend'.
--
--   You can make a 'StyledPlot' with 'styleDynamic'
data StyledPlot b v n where
  StyledPlot
    :: Plotable p b
    =&gt; p
    -&gt; PlotOptions b (V p) (N p)
    -&gt; PlotStyle b (V p) (N p)
    -&gt; StyledPlot b (V p) (N p)

type instance V (StyledPlot b v n) = v
type instance N (StyledPlot b v n) = n

instance Functor f =&gt; HasPlotOptions f (StyledPlot b v n) b where
  plotOptions f (StyledPlot p opts sty) =
    f opts &lt;&amp;&gt; \opts' -&gt; StyledPlot p opts' sty

instance (Metric v, OrderedField n) =&gt; Enveloped (StyledPlot b v n) where
  getEnvelope (StyledPlot p opts _) =
    getEnvelope p &amp; transform (poTransform opts)

instance Functor f =&gt; HasPlotStyle f (StyledPlot b v n) b where
  plotStyle f (StyledPlot p opts sty) =
    f sty &lt;&amp;&gt; StyledPlot p opts

-- | Traversal over a raw plot of a styled plot. The type of the plot
--   must match for the traversal to be successful.
styledPlot :: forall p b. Typeable p =&gt; Traversal' (StyledPlot b (V p) (N p)) p
styledPlot f s@(StyledPlot p opts sty) =
  case eq p of
    Just Refl -&gt; f p &lt;&amp;&gt; \p' -&gt; StyledPlot p' opts sty
    Nothing   -&gt; pure s
  where eq :: Typeable a =&gt; a -&gt; Maybe (a :~: p)
        eq _ = eqT

-- | Give a 'DynamicPlot' a concrete 'PlotStyle'.
styleDynamic :: PlotStyle b v n -&gt; DynamicPlot b v n -&gt; StyledPlot b v n
styleDynamic sty (DynamicPlot (Plot p opts styF)) = StyledPlot p opts (styF sty)

-- | Render a 'StyledPlot' given an and 'AxisSpec'.
renderStyledPlot
  :: TypeableFloat n
  =&gt; AxisSpec V2 n
  -&gt; StyledPlot b V2 n
  -&gt; QDiagram b V2 n Any
renderStyledPlot aSpec (StyledPlot p opts sty)
  = renderPlotable aSpec sty p
      &amp; whenever (opts^.hidden) phantom
      &amp; whenever (opts^.clipPlot) (clipTo $ specRect aSpec)

specRect :: TypeableFloat n =&gt; AxisSpec V2 n -&gt; Path V2 n
specRect aSpec =
  rect (xU - xL) (yU - yL)
    # moveTo (mkP2 ((xU+xL)/2) ((yU+yL)/2))
    # transform t
  where
  V2 (xL,xU) (yL,yU) = _specBounds aSpec
  t                   = _specTrans aSpec

-- | Get the legend rendered entries from a single styled plot. The
--   resulting entries are in no particular order. See also
--   'styledPlotLegends'.
singleStyledPlotLegend
  :: StyledPlot b v n
  -&gt; [(n, QDiagram b v n Any, String)] -- ^ @(z-order, legend pic, legend text)@
singleStyledPlotLegend (StyledPlot p opts sty) =
  map mk (opts ^. legendEntries)
  where
    mk entry = (entry ^. legendPrecedence, pic, entry ^. legendText)
      where
        pic = case lPic entry of
                DefaultLegendPic  -&gt; defLegendPic sty p
                CustomLegendPic f -&gt; f sty

-- | Render a list of legend entries, in order.
styledPlotLegends
  :: Ord n
  =&gt; [StyledPlot b v n]
  -&gt; [(QDiagram b v n Any, String)] -- ^ @[(legend pic, legend text)]@
styledPlotLegends
  = map (\(_,p,t) -&gt; (p,t))
  . sortOn (view _1)
  . concatMap singleStyledPlotLegend

-- XXX taken from &quot;Data.List&quot;, defined here because it was only added in
-- base-4.8 (ghc-7.10)
sortOn :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
sortOn f =
  map snd . sortBy (comparing fst) . map (\x -&gt; let y = f x in y `seq` (y, x))

</span></pre></body></html>